%General Mission Analysis Tool(GMAT) Script
%Created: 2025-07-08 00:31:01

%----------------------------------------
%---------- User-Defined Celestial Bodies
%----------------------------------------

Create Moon Ariel;
Ariel.NAIFId = 701;
Ariel.OrbitSpiceKernelName = {'C:\Users\Lucas\Dell Laptop Backup Feb 22, 2023\Arzy\Desktop\University\Corn\GMAT\gmat-win-R2025a\GMAT_R2025a\data\planetary_ephem\spk\ura182.bsp'};
Ariel.OrbitColor = Tan;
Ariel.TargetColor = DarkGray;
Ariel.EquatorialRadius = 578.9;
Ariel.Flattening = 0;
Ariel.Mu = 86.0946;
Ariel.PosVelSource = 'SPICE';
Ariel.CentralBody = 'Uranus';
Ariel.RotationDataSource = 'IAUSimplified';
Ariel.OrientationEpoch = 21545;
Ariel.SpinAxisRAConstant = 0;
Ariel.SpinAxisRARate = 0;
Ariel.SpinAxisDECConstant = 90;
Ariel.SpinAxisDECRate = 0;
Ariel.RotationConstant = 0;
Ariel.RotationRate = 0;
Ariel.TextureMapFileName = 'GenericCelestialBody.jpg';
Ariel.3DModelFile = '';
Ariel.3DModelOffsetX = 0;
Ariel.3DModelOffsetY = 0;
Ariel.3DModelOffsetZ = 0;
Ariel.3DModelRotationX = 0;
Ariel.3DModelRotationY = 0;
Ariel.3DModelRotationZ = 0;
Ariel.3DModelScale = 10;

Create Moon Miranda;
Miranda.NAIFId = 705;
Miranda.OrbitSpiceKernelName = {'C:\Users\Lucas\Dell Laptop Backup Feb 22, 2023\Arzy\Desktop\University\Corn\GMAT\gmat-win-R2025a\GMAT_R2025a\data\planetary_ephem\spk\ura182.bsp'};
Miranda.OrbitColor = Tan;
Miranda.TargetColor = DarkGray;
Miranda.EquatorialRadius = 235.7;
Miranda.Flattening = 0;
Miranda.Mu = 4.4048;
Miranda.PosVelSource = 'SPICE';
Miranda.CentralBody = 'Uranus';
Miranda.RotationDataSource = 'IAUSimplified';
Miranda.OrientationEpoch = 21545;
Miranda.SpinAxisRAConstant = 0;
Miranda.SpinAxisRARate = 0;
Miranda.SpinAxisDECConstant = 90;
Miranda.SpinAxisDECRate = 0;
Miranda.RotationConstant = 0;
Miranda.RotationRate = 0;
Miranda.TextureMapFileName = 'GenericCelestialBody.jpg';
Miranda.3DModelFile = '';
Miranda.3DModelOffsetX = 0;
Miranda.3DModelOffsetY = 0;
Miranda.3DModelOffsetZ = 0;
Miranda.3DModelRotationX = 0;
Miranda.3DModelRotationY = 0;
Miranda.3DModelRotationZ = 0;
Miranda.3DModelScale = 10;

Create Moon Umbriel;
Umbriel.NAIFId = 702;
Umbriel.OrbitSpiceKernelName = {'C:\Users\Lucas\Dell Laptop Backup Feb 22, 2023\Arzy\Desktop\University\Corn\GMAT\gmat-win-R2025a\GMAT_R2025a\data\planetary_ephem\spk\ura182.bsp'};
Umbriel.OrbitColor = Tan;
Umbriel.TargetColor = DarkGray;
Umbriel.EquatorialRadius = 584.7;
Umbriel.Flattening = 0;
Umbriel.Mu = 81.4228;
Umbriel.PosVelSource = 'SPICE';
Umbriel.CentralBody = 'Uranus';
Umbriel.RotationDataSource = 'IAUSimplified';
Umbriel.OrientationEpoch = 21545;
Umbriel.SpinAxisRAConstant = 0;
Umbriel.SpinAxisRARate = 0;
Umbriel.SpinAxisDECConstant = 90;
Umbriel.SpinAxisDECRate = 0;
Umbriel.RotationConstant = 0;
Umbriel.RotationRate = 0;
Umbriel.TextureMapFileName = 'GenericCelestialBody.jpg';
Umbriel.3DModelFile = '';
Umbriel.3DModelOffsetX = 0;
Umbriel.3DModelOffsetY = 0;
Umbriel.3DModelOffsetZ = 0;
Umbriel.3DModelRotationX = 0;
Umbriel.3DModelRotationY = 0;
Umbriel.3DModelRotationZ = 0;
Umbriel.3DModelScale = 10;

Create Moon Mab;
Mab.NAIFId = 726;
Mab.OrbitSpiceKernelName = {'C:\Users\Lucas\Dell Laptop Backup Feb 22, 2023\Arzy\Desktop\University\Corn\GMAT\gmat-win-R2025a\GMAT_R2025a\data\planetary_ephem\spk\ura115.bsp'};
Mab.OrbitColor = Tan;
Mab.TargetColor = DarkGray;
Mab.EquatorialRadius = 12;
Mab.Flattening = 0;
Mab.Mu = 6.674e-05;
Mab.PosVelSource = 'SPICE';
Mab.CentralBody = 'Uranus';
Mab.RotationDataSource = 'IAUSimplified';
Mab.OrientationEpoch = 21545;
Mab.SpinAxisRAConstant = 0;
Mab.SpinAxisRARate = 0;
Mab.SpinAxisDECConstant = 90;
Mab.SpinAxisDECRate = 0;
Mab.RotationConstant = 0;
Mab.RotationRate = 0;
Mab.TextureMapFileName = 'GenericCelestialBody.jpg';
Mab.3DModelFile = '';
Mab.3DModelOffsetX = 0;
Mab.3DModelOffsetY = 0;
Mab.3DModelOffsetZ = 0;
Mab.3DModelRotationX = 0;
Mab.3DModelRotationY = 0;
Mab.3DModelRotationZ = 0;
Mab.3DModelScale = 10;

Create Moon Titania;
Titania.NAIFId = 703;
Titania.OrbitSpiceKernelName = {'C:\Users\Lucas\Dell Laptop Backup Feb 22, 2023\Arzy\Desktop\University\Corn\GMAT\gmat-win-R2025a\GMAT_R2025a\data\planetary_ephem\spk\ura182.bsp'};
Titania.OrbitColor = Tan;
Titania.TargetColor = DarkGray;
Titania.EquatorialRadius = 788.9;
Titania.Flattening = 0;
Titania.Mu = 228.2508;
Titania.PosVelSource = 'SPICE';
Titania.CentralBody = 'Uranus';
Titania.RotationDataSource = 'IAUSimplified';
Titania.OrientationEpoch = 21545;
Titania.SpinAxisRAConstant = 0;
Titania.SpinAxisRARate = 0;
Titania.SpinAxisDECConstant = 90;
Titania.SpinAxisDECRate = 0;
Titania.RotationConstant = 0;
Titania.RotationRate = 0;
Titania.TextureMapFileName = 'GenericCelestialBody.jpg';
Titania.3DModelFile = '';
Titania.3DModelOffsetX = 0;
Titania.3DModelOffsetY = 0;
Titania.3DModelOffsetZ = 0;
Titania.3DModelRotationX = 0;
Titania.3DModelRotationY = 0;
Titania.3DModelRotationZ = 0;
Titania.3DModelScale = 10;

Create Moon Oberon;
Oberon.NAIFId = 704;
Oberon.OrbitSpiceKernelName = {'C:\Users\Lucas\Dell Laptop Backup Feb 22, 2023\Arzy\Desktop\University\Corn\GMAT\gmat-win-R2025a\GMAT_R2025a\data\planetary_ephem\spk\ura182.bsp'};
Oberon.OrbitColor = Tan;
Oberon.TargetColor = DarkGray;
Oberon.EquatorialRadius = 761.4;
Oberon.Flattening = 0;
Oberon.Mu = 192.2112;
Oberon.PosVelSource = 'SPICE';
Oberon.CentralBody = 'Uranus';
Oberon.RotationDataSource = 'IAUSimplified';
Oberon.OrientationEpoch = 21545;
Oberon.SpinAxisRAConstant = 0;
Oberon.SpinAxisRARate = 0;
Oberon.SpinAxisDECConstant = 90;
Oberon.SpinAxisDECRate = 0;
Oberon.RotationConstant = 0;
Oberon.RotationRate = 0;
Oberon.TextureMapFileName = 'GenericCelestialBody.jpg';
Oberon.3DModelFile = '';
Oberon.3DModelOffsetX = 0;
Oberon.3DModelOffsetY = 0;
Oberon.3DModelOffsetZ = 0;
Oberon.3DModelRotationX = 0;
Oberon.3DModelRotationY = 0;
Oberon.3DModelRotationZ = 0;
Oberon.3DModelScale = 10;

%----------------------------------------
%---------- Spacecraft
%----------------------------------------

Create Spacecraft UOP;
UOP.DateFormat = UTCGregorian;
UOP.Epoch = '09 Oct 2047 18:00:00.001';
UOP.CoordinateSystem = UranusEq;
UOP.DisplayStateType = Keplerian;
UOP.SMA = 906249.9999753678;
UOP.ECC = 0.8620999999965201;
UOP.INC = 180;
UOP.RAAN = 0;
UOP.AOP = -0;
UOP.TA = 180;
UOP.DryMass = 850;
UOP.Cd = 2.2;
UOP.Cr = 1.8;
UOP.DragArea = 15;
UOP.SRPArea = 1;
UOP.SPADDragScaleFactor = 1;
UOP.SPADSRPScaleFactor = 1;
UOP.AtmosDensityScaleFactor = 1;
UOP.ExtendedMassPropertiesModel = 'None';
UOP.NAIFId = -10016001;
UOP.NAIFIdReferenceFrame = -9016001;
UOP.OrbitColor = Red;
UOP.TargetColor = Teal;
UOP.OrbitErrorCovariance = [ 1e+70 0 0 0 0 0 ; 0 1e+70 0 0 0 0 ; 0 0 1e+70 0 0 0 ; 0 0 0 1e+70 0 0 ; 0 0 0 0 1e+70 0 ; 0 0 0 0 0 1e+70 ];
UOP.CdSigma = 1e+70;
UOP.CrSigma = 1e+70;
UOP.Id = 'SatId';
UOP.Attitude = CoordinateSystemFixed;
UOP.SPADSRPInterpolationMethod = Bilinear;
UOP.SPADSRPScaleFactorSigma = 1e+70;
UOP.SPADDragInterpolationMethod = Bilinear;
UOP.SPADDragScaleFactorSigma = 1e+70;
UOP.AtmosDensityScaleFactorSigma = 1e+70;
UOP.ModelFile = 'aura.3ds';
UOP.ModelOffsetX = 0;
UOP.ModelOffsetY = 0;
UOP.ModelOffsetZ = 0;
UOP.ModelRotationX = 0;
UOP.ModelRotationY = 0;
UOP.ModelRotationZ = 0;
UOP.ModelScale = 1;
UOP.AttitudeDisplayStateType = 'Quaternion';
UOP.AttitudeRateDisplayStateType = 'AngularVelocity';
UOP.AttitudeCoordinateSystem = UranusEq;
UOP.EulerAngleSequence = '321';








%----------------------------------------
%---------- ForceModels
%----------------------------------------

Create ForceModel DefaultProp_ForceModel;
DefaultProp_ForceModel.CentralBody = Uranus;
DefaultProp_ForceModel.PointMasses = {Ariel, Mab, Miranda, Oberon, Titania, Umbriel, Uranus};
DefaultProp_ForceModel.Drag = None;
DefaultProp_ForceModel.SRP = Off;
DefaultProp_ForceModel.RelativisticCorrection = Off;
DefaultProp_ForceModel.ErrorControl = RSSStep;

%----------------------------------------
%---------- Propagators
%----------------------------------------

Create Propagator DefaultProp;
DefaultProp.FM = DefaultProp_ForceModel;
DefaultProp.Type = RungeKutta89;
DefaultProp.InitialStepSize = 60;
DefaultProp.Accuracy = 9.999999999999999e-12;
DefaultProp.MinStep = 0.001;
DefaultProp.MaxStep = 2700;
DefaultProp.MaxStepAttempts = 50;
DefaultProp.StopIfAccuracyIsViolated = true;

%----------------------------------------
%---------- Coordinate Systems
%----------------------------------------

Create CoordinateSystem UranusEq;
UranusEq.Origin = Uranus;
UranusEq.Axes = Equator;

Create CoordinateSystem UOPfixed;
UOPfixed.Origin = UOP;
UOPfixed.Axes = ObjectReferenced;
UOPfixed.XAxis = V;
UOPfixed.YAxis = N;
UOPfixed.Primary = Uranus;
UOPfixed.Secondary = UOP;

%----------------------------------------
%---------- Subscribers
%----------------------------------------

Create OrbitView UranusOrbitView;
UranusOrbitView.SolverIterations = Current;
UranusOrbitView.UpperLeft = [ 0.1508739650413984 0.05263157894736842 ];
UranusOrbitView.Size = [ 0.8831646734130635 0.8152295632698768 ];
UranusOrbitView.RelativeZOrder = 36;
UranusOrbitView.Maximized = false;
UranusOrbitView.Add = {UOP, Mab, Ariel, Miranda, Oberon, Titania, Umbriel, Uranus};
UranusOrbitView.CoordinateSystem = UranusEq;
UranusOrbitView.DrawObject = [ true true true true true true true true ];
UranusOrbitView.DataCollectFrequency = 1;
UranusOrbitView.UpdatePlotFrequency = 50;
UranusOrbitView.NumPointsToRedraw = 0;
UranusOrbitView.ShowPlot = true;
UranusOrbitView.MaxPlotPoints = 20000;
UranusOrbitView.ShowLabels = true;
UranusOrbitView.ViewPointReference = Uranus;
UranusOrbitView.ViewPointVector = [ 1687500 0 0 ];
UranusOrbitView.ViewDirection = Uranus;
UranusOrbitView.ViewScaleFactor = 1;
UranusOrbitView.ViewUpCoordinateSystem = UranusEq;
UranusOrbitView.ViewUpAxis = Z;
UranusOrbitView.EclipticPlane = Off;
UranusOrbitView.XYPlane = On;
UranusOrbitView.WireFrame = Off;
UranusOrbitView.Axes = On;
UranusOrbitView.Grid = Off;
UranusOrbitView.SunLine = Off;
UranusOrbitView.UseInitialView = On;
UranusOrbitView.StarCount = 7000;
UranusOrbitView.EnableStars = On;
UranusOrbitView.EnableConstellations = On;

%----------------------------------------
%---------- Subscribers
%----------------------------------------

Create OrbitView UOPOrbitView;
UOPOrbitView.SolverIterations = Current;
UOPOrbitView.UpperLeft = [ 0 0.1131019036954087 ];
UOPOrbitView.Size = [ 0.8831646734130635 0.8152295632698768 ];
UOPOrbitView.RelativeZOrder = 34;
UOPOrbitView.Maximized = false;
UOPOrbitView.Add = {UOP, Mab, Ariel, Miranda, Oberon, Titania, Umbriel, Uranus};
UOPOrbitView.CoordinateSystem = UOPfixed;
UOPOrbitView.DrawObject = [ true true true true true true true true ];
UOPOrbitView.DataCollectFrequency = 1;
UOPOrbitView.UpdatePlotFrequency = 50;
UOPOrbitView.NumPointsToRedraw = 0;
UOPOrbitView.ShowPlot = true;
UOPOrbitView.MaxPlotPoints = 20000;
UOPOrbitView.ShowLabels = true;
UOPOrbitView.ViewPointReference = UOP;
UOPOrbitView.ViewPointVector = [ 3000 0 0 ];
UOPOrbitView.ViewDirection = UOP;
UOPOrbitView.ViewScaleFactor = 1;
UOPOrbitView.ViewUpCoordinateSystem = UranusEq;
UOPOrbitView.ViewUpAxis = Z;
UOPOrbitView.EclipticPlane = Off;
UOPOrbitView.XYPlane = On;
UOPOrbitView.WireFrame = Off;
UOPOrbitView.Axes = On;
UOPOrbitView.Grid = Off;
UOPOrbitView.SunLine = Off;
UOPOrbitView.UseInitialView = On;
UOPOrbitView.StarCount = 7000;
UOPOrbitView.EnableStars = On;
UOPOrbitView.EnableConstellations = On;

Create OpenFramesInterface OpenFrames1;
OpenFrames1.SolverIterations = Current;
OpenFrames1.UpperLeft = [ 0.06439742410303588 0.05599104143337066 ];
OpenFrames1.Size = [ 0.8104875804967802 0.8409854423292273 ];
OpenFrames1.RelativeZOrder = 26;
OpenFrames1.Maximized = false;
OpenFrames1.Add = {UOP, Ariel, Mab, Oberon, Miranda, Uranus, Umbriel, Titania};
OpenFrames1.View = {CoordinateSystemView1, ArielView1, MabView1, OberonView1, MirandaView1, UranusView1, UmbrielView1, TitaniaView1, UOPView1};
OpenFrames1.CoordinateSystem = UranusEq;
OpenFrames1.DrawObject = [ true true true true true true true true ];
OpenFrames1.DrawTrajectory = [ true true true true true true true true ];
OpenFrames1.DrawAxes = [ false false false false false false false false ];
OpenFrames1.DrawXYPlane = [ false false false false false false false false ];
OpenFrames1.DrawLabel = [ true true true true true true true true ];
OpenFrames1.DrawUsePropLabel = [ false false false false false false false false ];
OpenFrames1.DrawCenterPoint = [ true false false false false false false false ];
OpenFrames1.DrawEndPoints = [ true false false false false false false false ];
OpenFrames1.DrawVelocity = [ false false false false false false false false ];
OpenFrames1.DrawGrid = [ false false false false false false false false ];
OpenFrames1.DrawLineWidth = [ 2 2 2 2 2 2 2 2 ];
OpenFrames1.DrawMarkerSize = [ 10 10 10 10 10 10 10 10 ];
OpenFrames1.DrawFontSize = [ 14 14 14 14 14 14 14 14 ];
OpenFrames1.Axes = On;
OpenFrames1.AxesLength = 12756.2726;
OpenFrames1.AxesLabels = On;
OpenFrames1.FrameLabel = Off;
OpenFrames1.XYPlane = On;
OpenFrames1.EclipticPlane = Off;
OpenFrames1.EnableStars = On;
OpenFrames1.StarCatalog = 'inp_StarsHYGv3.txt';
OpenFrames1.StarCount = 40000;
OpenFrames1.MinStarMag = -2;
OpenFrames1.MaxStarMag = 6;
OpenFrames1.MinStarPixels = 1;
OpenFrames1.MaxStarPixels = 10;
OpenFrames1.MinStarDimRatio = 0.5;
OpenFrames1.ShowPlot = true;
OpenFrames1.ShowToolbar = true;
OpenFrames1.SolverIterLastN = 1;
OpenFrames1.ShowVR = false;
OpenFrames1.PlaybackTimeScale = 3600;
OpenFrames1.MultisampleAntiAliasing = On;
OpenFrames1.MSAASamples = 2;
OpenFrames1.DrawFontPosition = {'Top-Right', 'Top-Right', 'Top-Right', 'Top-Right', 'Top-Right', 'Top-Right', 'Top-Right', 'Top-Right'};

%----------------------------------------
%---------- User Objects
%----------------------------------------

Create OpenFramesView CoordinateSystemView1;
CoordinateSystemView1.ViewFrame = CoordinateSystem;
CoordinateSystemView1.ViewTrajectory = Off;
CoordinateSystemView1.InertialFrame = Off;
CoordinateSystemView1.SetDefaultLocation = Off;
CoordinateSystemView1.SetCurrentLocation = On;
CoordinateSystemView1.CurrentEye = [ -53681.17230488369 57661.10079579285 455100.3621533489 ];
CoordinateSystemView1.CurrentCenter = [ -2.182787284255028e-11 -6.548361852765083e-11 -5.820766091346741e-11 ];
CoordinateSystemView1.CurrentUp = [ -0.8559674467696268 -0.5158017260473577 -0.03561333285797243 ];
CoordinateSystemView1.FOVy = 45;

Create OpenFramesView ArielView1;
ArielView1.ViewFrame = Ariel;
ArielView1.ViewTrajectory = Off;
ArielView1.InertialFrame = Off;
ArielView1.SetDefaultLocation = Off;
ArielView1.SetCurrentLocation = Off;
ArielView1.FOVy = 45;

Create OpenFramesView MabView1;
MabView1.ViewFrame = Mab;
MabView1.ViewTrajectory = Off;
MabView1.InertialFrame = Off;
MabView1.SetDefaultLocation = Off;
MabView1.SetCurrentLocation = Off;
MabView1.FOVy = 45;

Create OpenFramesView OberonView1;
OberonView1.ViewFrame = Oberon;
OberonView1.ViewTrajectory = Off;
OberonView1.InertialFrame = Off;
OberonView1.SetDefaultLocation = Off;
OberonView1.SetCurrentLocation = Off;
OberonView1.FOVy = 45;

Create OpenFramesView MirandaView1;
MirandaView1.ViewFrame = Miranda;
MirandaView1.ViewTrajectory = Off;
MirandaView1.InertialFrame = Off;
MirandaView1.SetDefaultLocation = Off;
MirandaView1.SetCurrentLocation = Off;
MirandaView1.FOVy = 45;

Create OpenFramesView UranusView1;
UranusView1.ViewFrame = Uranus;
UranusView1.ViewTrajectory = Off;
UranusView1.InertialFrame = Off;
UranusView1.SetDefaultLocation = Off;
UranusView1.SetCurrentLocation = Off;
UranusView1.FOVy = 45;

Create OpenFramesView UmbrielView1;
UmbrielView1.ViewFrame = Umbriel;
UmbrielView1.ViewTrajectory = Off;
UmbrielView1.InertialFrame = Off;
UmbrielView1.SetDefaultLocation = Off;
UmbrielView1.SetCurrentLocation = Off;
UmbrielView1.FOVy = 45;

Create OpenFramesView TitaniaView1;
TitaniaView1.ViewFrame = Titania;
TitaniaView1.ViewTrajectory = Off;
TitaniaView1.InertialFrame = Off;
TitaniaView1.SetDefaultLocation = Off;
TitaniaView1.SetCurrentLocation = Off;
TitaniaView1.FOVy = 45;

Create OpenFramesView UOPView1;
UOPView1.ViewFrame = UOP;
UOPView1.ViewTrajectory = Off;
UOPView1.InertialFrame = Off;
UOPView1.SetDefaultLocation = Off;
UOPView1.SetCurrentLocation = Off;
UOPView1.FOVy = 45;


%----------------------------------------
%---------- Mission Sequence
%----------------------------------------

BeginMissionSequence;
Propagate DefaultProp(UOP) {UOP.ElapsedDays = 28};
